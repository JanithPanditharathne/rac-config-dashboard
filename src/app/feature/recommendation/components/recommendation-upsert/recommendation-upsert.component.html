<div class="page-content add-email-rec" #recFormParent>
    <app-action-bar [breadcrumb]="actionBreadcrumb"></app-action-bar>
    <div class="page-content-pane">
        <div class="container-fluid relative-parent">
            <div class="row">
                <div class="col-lg-12">
                    <form [formGroup]="recForm" novalidate>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-container">
                                    <div class="form-group" [class.input-error]="isInvalid('recName')">
                                        <label for="recName"
                                        >Rec Name<span class="required-label">*</span>
                                            <input class="form-control" type="text" formControlName="recName"
                                                   placeholder="Rec Name" id="recName"/>
                                        </label>
                                        <app-character-length-range-error
                                                [control]="recForm.get('recName')"
                                                [lengthError]="'Recommendation name must not be greater than 200 characters long'"
                                                [requiredError]="'Recommendation name is required'"
                                        >
                                        </app-character-length-range-error>
                                    </div>
                                    <div class="form-heading-container">
                                        <h2>Bundle</h2>
                                    </div>
                                    <div class="form-group" [class.input-error]="isInvalid('selectedBundle')">
                                        <label
                                        >Select existing bundle<span class="required-label">*</span>
                                            <ng-dropdown
                                                    [id]="'bundle-dropdown-data'"
                                                    [selectTrackBy]="'id'"
                                                    [displayTrackBy]="'name'"
                                                    [formControlName]="'selectedBundle'"
                                                    [relativeParentElement]="recFormParent"
                                                    [options]="bundleDropdownData"
                                                    [selectMode]="dropdownSelectMode"
                                                    [filterable]="true"
                                                    [closeMenuOnSelect]="true"
                                            >
                                            </ng-dropdown>
                                        </label>
                                        <app-required-error [control]="recForm.get('selectedBundle')"
                                                            [requiredError]="'Bundle is required'"
                                                            [errorType]="'required'">
                                        </app-required-error>
                                    </div>
                                    <div>OR</div>
                                    <hr>
                                    <app-action [type]="ActionType.ADD"
                                                [name]="'Create New Bundle'"
                                                [autoResolve]="true"
                                                (actionClick)="switchSidePaneVisibility()"
                                    >
                                    </app-action>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <app-side-pane>
            <div class="right-pane" [class.active]="isBundleAdd">
                <ng-container>
                    <app-bundle-form [bundle]="null"
                                     [isPopupView]="true"
                                     [formAction]="FormAction.ADD"
                                     (saveBundle)="onBundleSaveClick($event)"
                                     (cancelBundle)="switchSidePaneVisibility()">
                    </app-bundle-form>
                </ng-container>
            </div>
        </app-side-pane>
        <div class="footer-button-container">
            <app-action-button-strap>
                <app-action [type]="ActionType.SAVE" [name]="formAction === FormAction.ADD ? 'Create': 'Save'"
                            [autoResolve]="false"
                            (actionClick)="onRecSaveClick($event)"></app-action>
                <app-action [type]="ActionType.CANCEL" [name]="'Cancel'"
                            (actionClick)="redirectToRecsView()"></app-action>
            </app-action-button-strap>
        </div>
    </div>
</div>
