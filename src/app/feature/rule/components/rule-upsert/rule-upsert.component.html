<div class="page-content add-email-rec" #ruleFormParent>
    <app-action-bar [breadcrumb]="actionBreadcrumb"></app-action-bar>
    <div class="page-content-pane">
        <div class="container-fluid relative-parent" #RuleUpsert>
            <div class="row">
                <div class="col-lg-12">
                    <form [formGroup]="ruleForm" novalidate>
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="form-container">
                                    <div class="form-group" [class.input-error]="isInvalid('ruleName')">
                                        <label for="ruleName"
                                        >Rule Name<span class="required-label">*</span>
                                            <input class="form-control" type="text" formControlName="ruleName"
                                                   placeholder="Rule Name" id="ruleName"/>
                                        </label>
                                        <app-character-length-range-error
                                                [control]="ruleForm.get('ruleName')"
                                                [lengthError]="'Rule name must not be greater than 200 characters long'"
                                                [requiredError]="'Rule name is required'"
                                        >
                                        </app-character-length-range-error>
                                    </div>
                                    <div class="form-group" [class.input-error]="isInvalid('ruleType')">
                                        <label
                                        >Rule Type<span class="required-label">*</span>
                                            <ng-dropdown
                                                    *ngIf="ruleTypeDropdownData"
                                                    [id]="'rule-type-dropdown-data'"
                                                    [selectTrackBy]="'id'"
                                                    [displayTrackBy]="'name'"
                                                    [formControlName]="'ruleType'"
                                                    [relativeParentElement]="ruleFormParent"
                                                    [options]="ruleTypeDropdownData"
                                                    [selectMode]="dropdownSelectMode"
                                                    [filterable]="true"
                                                    [closeMenuOnSelect]="true"
                                            >
                                            </ng-dropdown>
                                        </label>
                                        <app-required-error [control]="ruleForm.get('ruleType')"
                                                            [requiredError]="'Rule type is required'"
                                                            [errorType]="'required'">
                                        </app-required-error>
                                    </div>
                                    <div class="form-group">
                                        <span>Is Global
                                            <div class="form-check mt-1 d-inline">
                                                <input
                                                        class="form-check-input checkbox-input"
                                                        type="checkbox"
                                                        id="isGlobal"
                                                        formControlName="isGlobal"/>
                                                <label class="combined-enabled-label" for="isGlobal"></label>
                                            </div>
                                        </span>
                                    </div>
                                    <app-rule-context
                                            [ruleGeneratorType]="RuleGeneratorType.MATCHING"
                                            [parentFormGroup]="ruleForm"
                                            [contextData]="rule?.matchingConditionJson"
                                            [parentElement]="RuleUpsert">
                                    </app-rule-context>
                                    <app-rule-context
                                            [ruleGeneratorType]="RuleGeneratorType.ACTION"
                                            [parentFormGroup]="ruleForm"
                                            [contextData]="rule?.actionConditionJson"
                                            [parentElement]="RuleUpsert">
                                    </app-rule-context>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="footer-button-container">
            <app-action-button-strap>
                <app-action [type]="ActionType.SAVE" [name]="formAction === FormAction.ADD ? 'Create': 'Save'"
                            [autoResolve]="false"
                            (actionClick)="onRecSaveClick($event)"></app-action>
                <app-action [type]="ActionType.CANCEL" [name]="'Cancel'"
                            (actionClick)="redirectToRulesView()"></app-action>
            </app-action-button-strap>
        </div>
    </div>
</div>
